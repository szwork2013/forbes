var app=angular.module("fbs",["ionic","ngSanitize","ngResource","ngCookies","fbs.controllers","fbs.filters","fbs.directives","fbs.services","shoppinpal.mobile-menu"]);app.config(function($stateProvider,$urlRouterProvider,$ionicConfigProvider,$resourceProvider){$resourceProvider.defaults.stripTrailingSlashes=!1,$ionicConfigProvider.views.maxCache(0),$urlRouterProvider.otherwise("/index"),$stateProvider.state("login",{url:"/login",views:{mainContent:{templateUrl:"pages/login.html",controller:"signCtrl"}}}).state("regist",{url:"/regist",views:{mainContent:{templateUrl:"pages/regist.html",controller:"signCtrl"}}}).state("index",{url:"/index",views:{mainContent:{templateUrl:"pages/index/index.html",controller:"indexCtrl"}}}).state("wd_list",{url:"/wd_list/:operat",views:{mainContent:{templateUrl:"pages/index/wd/wd_list.html",controller:"wendaListCtrl"}}}).state("wd_single",{url:"/wd_single/:wendaId",views:{mainContent:{templateUrl:"pages/index/wd/wd_single.html",controller:"wendaSingleCtrl"}}}).state("wd_add",{url:"/wd_add/:touserid",views:{mainContent:{templateUrl:"pages/index/wd/wd_add.html",controller:"wendaAddCtrl"}}}).state("activity_list",{url:"/activity_list/:operat",views:{mainContent:{templateUrl:"pages/index/activity/activity_list.html",controller:"activityListCtrl"}}}).state("activity_single",{url:"/activity_single/:activityId",views:{mainContent:{templateUrl:"pages/index/activity/activity_single.html",controller:"activitySingleCtrl"}}}).state("article_list",{url:"/article_list",views:{mainContent:{templateUrl:"pages/index/article/article_list.html",controller:"articleListCtrl"}}}).state("article_single",{url:"/article_single/:newsid",views:{mainContent:{templateUrl:"pages/index/article/article_single.html",controller:"articleSingleCtrl"}}}).state("licaishi_list",{url:"/licaishi_list/:operat",views:{mainContent:{templateUrl:"pages/index/licaishi/licaishi_list.html",controller:"licaishiListCtrl"}}}).state("licaishi_single",{url:"/licaishi_single/:licaishiId",views:{mainContent:{templateUrl:"pages/index/licaishi/licaishi_single.html",controller:"licaishiSingleCtrl"}}}).state("fx",{url:"/fx",views:{mainContent:{templateUrl:"pages/fx/fx.html"}}}).state("jfph",{url:"/jfph",views:{mainContent:{templateUrl:"pages/fx/jfph.html",controller:"faxianCtrl"}}}).state("lcs",{url:"/lcs",views:{mainContent:{templateUrl:"pages/fx/lcs.html",controller:"faxianCtrl"}}}).state("lcs_apply",{url:"/lcs_apply",views:{mainContent:{templateUrl:"pages/fx/lcs_unapply.html",controller:"licaishiOtherCtrl"}}}).state("lcs_history",{url:"/lcs_history",views:{mainContent:{templateUrl:"pages/fx/lcs_history.html",controller:"licaishiHistoryCtrl"}}}).state("grzx",{url:"/grzx",views:{mainContent:{templateUrl:"pages/grzx/grzx.html",controller:"personCtrl"}}}).state("wdjf",{url:"/wdjf",views:{mainContent:{templateUrl:"pages/grzx/wdjf.html",controller:"personCtrl"}}}).state("gxzl",{url:"/gxzl",views:{mainContent:{templateUrl:"pages/grzx/gxzl.html",controller:"personCtrl"}}}).state("xx",{url:"/xx",views:{mainContent:{templateUrl:"pages/xx/xx.html",controller:"xiaoxiCtrl"}}}).state("xx_list",{url:"/xx_list/:operat",views:{mainContent:{templateUrl:"pages/xx/xx_list.html"}}}).state("wjlb",{url:"/wjlb/:operat",views:{mainContent:{templateUrl:"pages/xx/wj_list.html",controller:"xiaoxiCtrl"}}}).state("wj",{url:"/wj",templateUrl:"pages/xx/wj.html"}).state("jfsc",{url:"/jfsc",views:{mainContent:{templateUrl:"pages/jfsc.html"}}}).state("pageList",{url:"/pageList",views:{mainContent:{templateUrl:"pages/pageList.html",controller:"pageListCtrl"}}})}),app.controller("appCtrl",function($scope,Tools,$rootScope,$interval,$http){$scope.format="M/d/yy h:mm:ss a",$scope.tab=1,$scope.selectTab=function(setTab){$scope.tab=setTab},$scope.isSelected=function(checkTab){return $scope.tab===checkTab},$scope.rollback=function(){Tools.pageReturn()},$rootScope.hidefooter=!1,$rootScope.msg_show=!1,$rootScope.msg_cont="操作成功",$rootScope.sharedata={title:"",imgurl:"",digest:"",shareSuccess:function(id,sharetype){$http.jsonp("http://forbes.comeoncloud.net/serv/pubapi.ashx?appid=appid&appsecret=appsecret&action=weixinsharecomplete&sharetype="+sharetype+"&id="+id+"&callback=JSON_CALLBACK").success(function(){}).error(function(){})}},$http.get("http://"+location.host+"/serv/wxapi.ashx?action=getjsapiconfig&url="+location.href).success(function(wxapidata){wx.config({debug:!1,appId:wxapidata.appId,timestamp:wxapidata.timestamp,nonceStr:wxapidata.nonceStr,signature:wxapidata.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]})}).error(function(){})}),angular.module("fbs.controllers",[]),angular.module("fbs.services",[]),angular.module("fbs.filters",[]),angular.module("fbs.directives",[]),angular.module("shoppinpal.mobile-menu",[]).run(["$rootScope","$spMenu",function($rootScope,$spMenu){$rootScope.$spMenu=$spMenu}]).provider("$spMenu",function(){this.$get=[function(){var menu={};return menu.show=function(selector){var menu=angular.element(document.querySelector("#"+selector));menu.addClass("show")},menu.hide=function(selector){var menu=angular.element(document.querySelector("#"+selector));menu.removeClass("show")},menu.toggle=function(selector){var menu=angular.element(document.querySelector("#"+selector));menu.toggleClass("show")},menu}]}),angular.module("fbs.controllers").controller("indexCtrl",function($scope,$state,DataAPI,$ionicSlideBoxDelegate,$interval,Tools){$scope.sliderImgs=DataAPI.get({action:"getslide"}),$interval(function(){$ionicSlideBoxDelegate.update()},1e3),$scope.msgListReqOptions={action:"getindexmsglist",pageindex:1,pagesize:10,sort:"time"},$scope.loading_show=!0,DataAPI.get($scope.msgListReqOptions).$promise.then(function(req){$scope.msgList=req,$scope.loading_show=!1}),$scope.goItem=function(url,operat){Tools.pageSkip(url,{operat:operat})},$scope.news_redirect=function(m_id,m_type){console.log(m_id+" "+m_type),0==m_type&&Tools.pageSkip("article_single",{newsid:m_id}),1==m_type&&Tools.pageSkip("activity_single",{activityId:m_id}),2==m_type&&Tools.pageSkip("wd_single",{wendaId:m_id}),3==m_type&&Tools.pageSkip("wd_single",{wendaId:m_id})}}),angular.module("fbs.controllers").controller("pageListCtrl",["$scope","$http","$state",function($scope){$scope.pageList=[{name:"首页",url:"index"},{name:"—问答",url:"wd"},{name:"——问答详情",url:"wd_single"},{name:"——创建问答",url:"wd_add"},{name:"—活动",url:"activity_list"},{name:"—文章",url:"article_list"},{name:"——文章详情",url:"article_single"},{name:"—理财师",url:"licaishi_list"},{name:"——理财师详情",url:"licaishi_single"},{name:"发现",url:"fx"},{name:"—积分排行",url:"jfph"},{name:"—优选理财师",url:"lcs"},{name:"—理财师报名",url:"lcs_apply"},{name:"—往届理财师",url:"lcs_history"},{name:"个人中心",url:"grzx"},{name:"—我的积分",url:"wdjf"},{name:"—更新资料",url:"gxzl"},{name:"消息",url:"xx"},{name:"—问卷列表",url:"wjlb"},{name:"——问卷",url:"wj"},{name:"积分商城",url:"jfsc"},{name:"登录",url:"login"},{name:"注册",url:"regist"}]}]),angular.module("fbs.controllers").controller("activityListCtrl",function($scope,$stateParams,Tools,DataAPI){var actionsUrl,operat=$stateParams.operat;actionsUrl="my"==operat?"getmyactivitylist":"getactivitylist",$scope.details=function(activityId){Tools.pageSkip("activity_single",{activityId:activityId})},$scope.loading_show=!0,$scope.activityListReqOptions={action:actionsUrl,pageindex:1,pagesize:10,keyword:""},$scope.ctgListReqOptions={action:"getactivitycategorylist",pageindex:1,pagesize:10},$scope.pageDatas={currentCateId:9999,categoryList:DataAPI.get($scope.ctgListReqOptions)},DataAPI.get($scope.activityListReqOptions).$promise.then(function(req){$scope.pageDatas.activityList=req,$scope.loading_show=!1})}).controller("activitySingleCtrl",function($rootScope,$scope,$stateParams,$location,$ionicScrollDelegate,$sce,DataAPI,$http){var activityId=$stateParams.activityId,sharetype=0;$scope.activity=DataAPI.get({action:"getactivitydetail",activityid:activityId}),$scope.apply_form={show:!1},$scope.toggle_apply=function(location){$scope.apply_form.show=!$scope.apply_form.show,$scope.apply_form.show&&($location.hash(location),$ionicScrollDelegate.anchorScroll("#"+location))},$scope.SkipValidation=function(value){return $sce.trustAsHtml(value)},$scope.apply_data={activityid:activityId,action:"submitactivitysigndata"},$scope.online_apply=function(){DataAPI.get($scope.apply_data)},$http.jsonp("http://forbes.comeoncloud.net/serv/pubapi.ashx?appid=appid&appsecret=appsecret&action=getactivitydetail&activityid="+activityId+"&callback=JSON_CALLBACK").success(function(data){$rootScope.sharedata.title=data.activityname,$rootScope.sharedata.imgurl=data.activityimage,$rootScope.sharedata.digest=data.activitycontent,wx.onMenuShareTimeline({title:$rootScope.sharedata.title,link:location.href,imgUrl:$rootScope.sharedata.imgurl,success:function(){sharetype=3,$rootScope.sharedata.shareSuccess(activityId,sharetype)},cancel:function(){}}),wx.onMenuShareAppMessage({title:$rootScope.sharedata.title,desc:$rootScope.sharedata.digest,link:location.href,imgUrl:$rootScope.sharedata.imgurl,type:"",dataUrl:"",success:function(){sharetype=2,$rootScope.sharedata.shareSuccess(activityId,sharetype)},cancel:function(){}})}).error(function(){})}),angular.module("fbs.controllers").controller("articleListCtrl",function($scope,Tools,DataAPI){$scope.details=function(newsid){Tools.pageSkip("article_single",{newsid:newsid})},$scope.loading_show=!0,$scope.loading_show=!0,$scope.articleListReqOptions={action:"getnewslist",pageindex:1,pagesize:10,keyword:""},$scope.ctgListReqOptions={action:"getnewscategorylist",pageindex:1,pagesize:10},$scope.pageDatas={currentCateId:9999,categoryList:DataAPI.get($scope.ctgListReqOptions)},DataAPI.get($scope.articleListReqOptions).$promise.then(function(req){$scope.pageDatas.articleList=req,$scope.loading_show=!1})}).controller("articleSingleCtrl",function($scope,$http,$stateParams,DataAPI,$sce){var articleId=$stateParams.newsid,title="",imgurl="",digest="",sharetype=0;$http.jsonp("http://forbes.comeoncloud.net/serv/pubapi.ashx?appid=appid&appsecret=appsecret&action=getnewsdetail&newsid="+articleId+"&callback=JSON_CALLBACK").success(function(data){title=data.title,imgurl=data.imgurl,digest=data.digest}).error(function(){}),$scope.article=DataAPI.get({action:"getnewsdetail",newsid:articleId}),$scope.SkipValidation=function(value){return $sce.trustAsHtml(value)},navigator.userAgent.match("MicroMessenger"),$http.get("http://"+location.host+"/serv/wxapi.ashx?action=getjsapiconfig&url="+location.href).success(function(wxapidata){wx.config({debug:!1,appId:wxapidata.appId,timestamp:wxapidata.timestamp,nonceStr:wxapidata.nonceStr,signature:wxapidata.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]})}).error(function(){}),wx.ready(function(){wx.onMenuShareTimeline({title:title,link:location.href,imgUrl:imgurl,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:title,desc:digest,link:location.href,imgUrl:imgurl,type:"",dataUrl:"",success:function(){sharetype=0,$scope.bbb(articleId,sharetype)},cancel:function(){}}),wx.onMenuShareQQ({title:title,desc:digest,link:location.href,imgUrl:imgUrl,success:function(){},cancel:function(){}})}),$scope.bbb=function(id,sharetype){$http.jsonp("http://forbes.comeoncloud.net/serv/pubapi.ashx?appid=appid&appsecret=appsecret&action=weixinsharecomplete&sharetype="+sharetype+"&id="+id+"&callback=JSON_CALLBACK").success(function(){}).error(function(){})}}),angular.module("fbs.controllers").controller("wendaListCtrl",function($scope,$state,DataAPI,$stateParams){$stateParams.operat;$scope.details=function(wendaId){$state.go("wd_single",{wendaId:wendaId})},$scope.loading_show=!0,$scope.wdListReqOptions={action:"getasklist",pageindex:1,pagesize:10},DataAPI.get($scope.wdListReqOptions).$promise.then(function(req){$scope.wendas=req,$scope.loading_show=!1})}).controller("wendaSingleCtrl",function($rootScope,$scope,$stateParams,$http,DataAPI){$scope.wendaId=$stateParams.wendaId,$scope.reqOptions={action:"getaskdetail",id:$scope.wendaId},$scope.wenda=DataAPI.get($scope.reqOptions),$http.jsonp("http://forbes.comeoncloud.net/serv/pubapi.ashx?appid=appid&appsecret=appsecret&action=getaskdetail&id="+$scope.wendaId+"&callback=JSON_CALLBACK").success(function(data){$rootScope.sharedata.title=data.ask.title,$rootScope.sharedata.imgurl="http://forbes.comeoncloud.net/customize/forbes/images/t2.png",$rootScope.sharedata.digest=data.ask.content,wx.onMenuShareTimeline({title:$rootScope.sharedata.title,link:location.href,imgUrl:$rootScope.sharedata.imgurl,success:function(){sharetype=7,$rootScope.sharedata.shareSuccess($scope.wendaId,sharetype)},cancel:function(){}}),wx.onMenuShareAppMessage({title:$rootScope.sharedata.title,desc:$rootScope.sharedata.digest,link:location.href,imgUrl:$rootScope.sharedata.imgurl,type:"",dataUrl:"",success:function(){sharetype=6,$rootScope.sharedata.shareSuccess($scope.wendaId,sharetype)},cancel:function(){}})}).error(function(){})}).controller("wendaAddCtrl",function($scope,$stateParams,$rootScope,DataAPI,Tools){var touserid;"none"!=$stateParams.touserid&&(touserid=$stateParams.touserid),$scope.wenda={},$scope.addWenda=function(){DataAPI.get({action:"addask",title:$scope.wenda.titles,content:$scope.wenda.content,touserid:touserid}).$promise.then(function(resp){0==resp.errcode?(Tools.msgShow(resp.errmsg),Tools.pageSkip("wd_list",{operat:"all"})):1==resp.errcode?(Tools.msgShow("请登录"),Tools.pageSkip("login",null)):2==resp.errcode&&Tools.msgShow(resp.errmsg)})},$scope.cancelAdd=function(){console.log("取消话题添加"),Tools.msgShow("请登录"),Tools.pageReturn()}}),angular.module("fbs.controllers").controller("licaishiListCtrl",function($scope,Tools,DataAPI,$stateParams,AtteLcs){var actionsUrl,operat=$stateParams.operat;actionsUrl="myatt"==operat?"getmyattentionlist":"myfans"==operat?"getmyfanslist":"getmasterlist",$scope.loading_show=!0,$scope.lcsListReqOptions={action:actionsUrl,pageindex:1,pagesize:10,sort:"time",keyword:""},$scope.ctgListReqOptions={action:"getmastertaglist",pageindex:1,pagesize:10},$scope.pageDatas={currentCateId:9999,categoryList:DataAPI.get($scope.ctgListReqOptions)},DataAPI.get($scope.lcsListReqOptions).$promise.then(function(req){$scope.pageDatas.licaishiList=req,$scope.loading_show=!1}),$scope.details=function(licaishiId){Tools.pageSkip("licaishi_single",{licaishiId:licaishiId})},$scope.atteLcs=function(licaishi,$event){$event.stopPropagation&&$event.stopPropagation(),AtteLcs.atte(licaishi)}}).controller("licaishiSingleCtrl",function($scope,Tools,$stateParams,DataAPI,AtteLcs){var licaishiId=$stateParams.licaishiId;$scope.licaishi=DataAPI.get({action:"getmasterdetail",userid:licaishiId}),$scope.zixun=function(){Tools.go("wd_add",{touserid:licaishiId})},$scope.atteLcs=function(licaishi){AtteLcs.atte(licaishi)}}).controller("licaishiOtherCtrl",function($scope,$http,DataAPI,Tools){DataAPI.get({action:"getcurrentuserinfo"}).$promise.then(function(resq){(resq.errcode=-2&&!resq.totalscore)?Tools.pageSkip("login"):($scope.personinf=resq,$scope.maindata.Name=resq.truename)});var activityId=291504;$scope.apply_data={},$scope.apply_data.K1=1,DataAPI.get({action:"getactivitydetail",activityid:activityId}).$promise.then(function(resp){$scope.applyForm=resp,console.log($scope.applyForm.signfield)}),$scope.checkboxdata1={cfp:{checked:!1,name:"国际金融理财师（CFP）"},afp:{checked:!1,name:"金融理财师（AFP）"},rfp:{checked:!1,name:"注册财务策划师（RFP）"},cwm:{checked:!1,name:"特许财富管理师（CWM）"},cpb:{checked:!1,name:"私人银行家（CPB）"},rfc:{checked:!1,name:"国际认证财务顾问师（RFC）"}},$scope.checkboxdata2={jt:{checked:!1,name:"家庭（个人）财务分析"},zc:{checked:!1,name:"资产管理或投资规划"},fx:{checked:!1,name:"风险管理或保险规划"},zv:{checked:!1,name:"子女教育金规划"},hf:{checked:!1,name:"换房规划"},sw:{checked:!1,name:"税务筹划"}},$scope.maindata={K9:0,Name:"",Phone:"",K1:1,K2:"",K3:"",K6:"",K8:"",K11:"本科",K4:"",K5:"",K7:"",K13:"",K15:""},$scope.submitdata=function(){for(aa in $scope.checkboxdata1)1==$scope.checkboxdata1[aa].checked&&($scope.maindata.K13+=$scope.checkboxdata1[aa].name+",");$scope.maindata.K13=$scope.maindata.K13.substring(0,$scope.maindata.K13.length-1);for(bb in $scope.checkboxdata2)1==$scope.checkboxdata2[bb].checked&&($scope.maindata.K15+=$scope.checkboxdata2[bb].name+",");$scope.maindata.K15=$scope.maindata.K15.substring(0,$scope.maindata.K15.length-1);var mainurl="http://forbes.comeoncloud.net/serv/pubapi.ashx";mainurl+="?action=submitactivitysigndata",mainurl+="&activityid=291504";for(cc in $scope.maindata)mainurl+="&"+cc+"="+$scope.maindata[cc];mainurl+="&callback=JSON_CALLBACK",$http.jsonp(mainurl).success(function(data){data.errcode||alert(data.errmsg),console.log("success"),console.log(data)}).error(function(error){console.log(error)})}}).controller("licaishiHistoryCtrl",function($scope,DataAPI){$scope.articleListReqOptions={action:"getnewslist",cateid:499,pageindex:1,pagesize:10,keyword:""},$scope.pageDatas={},$scope.loading_show=!0,DataAPI.get($scope.articleListReqOptions).$promise.then(function(req){$scope.pageDatas.articleList=req,$scope.loading_show=!1})}),angular.module("fbs.controllers").controller("faxianCtrl",function($scope,$state,DataAPI,$sce){$scope.details=function(activityId){$state.go("activity_single",{activityId:activityId})},$scope.jfphList=DataAPI.get({action:"getscoreranklist",pagesize:10}),DataAPI.get({action:"getnewsdetail",newsid:294991}).$promise.then(function(resp){$scope.article=resp}),$scope.SkipValidation=function(value){return $sce.trustAsHtml(value)},$scope.sexy=1}),angular.module("fbs.controllers").controller("xiaoxiCtrl",function($scope,$stateParams,$state,DataAPI){var actionsUrl,operat=$stateParams.operat;actionsUrl="my"==operat?"getmyquestionnairelist":"getsystemnoticelist",$scope.wenjuanList=DataAPI.get({action:actionsUrl,noticetype:1,pageindex:1,pagesize:10}),$scope.xtxxList=DataAPI.get({action:"getsystemnoticelist",noticetype:0,pageindex:1,pagesize:10}),$scope.wdxtxx=DataAPI.get({action:"getunredsystemnoticecount",noticetype:0})}),angular.module("fbs.controllers").controller("personCtrl",function($scope,$state,$cookieStore,DataAPI,Tools){DataAPI.get({action:"getcurrentuserinfo"}).$promise.then(function(resq){resq.headimg?$scope.personinf=resq:(console.log("去登录"),Tools.pageSkip("login"))}),$scope.gxzl=function(){DataAPI.get({action:"updatecurrentuserinfo",truename:$scope.personinf.truename,postion:$scope.personinf.postion,company:$scope.personinf.company}).$promise.then(function(resq){0==resq.errcode?Tools.pageSkip("grzx"):Tools.msgShow(resq.errmsg)})},$scope.wdjf=DataAPI.get({action:"getscorerecordlist",pageindex:1,pagesize:10}),$scope.redir=function(url,p){$state.go(url,{operat:p},{location:!0,reload:!0})},$scope.logout=function(){var logoutdata={action:"loginout"};DataAPI.get(logoutdata).$promise.then(function(resp){resp.errcode||$state.go("login")})}}),angular.module("fbs.controllers").controller("signCtrl",function($scope,DataAPI,Tools){$scope.signInData={},$scope.signInData.action="login",$scope.signInData.userid="",$scope.signInData.pwd="",$scope.login=function(){DataAPI.get($scope.signInData).$promise.then(function(resp){console.log(resp),resp.issuccess?Tools.pageReturn():(Tools.msgShow(resp.message),$scope.signInData.userid="",$scope.signInData.pwd="")})},$scope.goToRegist=function(){Tools.pageSkip("regist")},$scope.registData={},$scope.registData.action="reg",$scope.registData.phone,$scope.registData.pwd,$scope.registSub=function(){DataAPI.get($scope.registData).$promise.then(function(resp){console.log(resp),0==resp.errcode?(alert("注册成功"),Tools.pageReturn()):alert(resp.errmsg)})},$scope.reqYzw=function(){}}),angular.module("fbs.services").factory("DataAPI",function($resource){var objClone=function(obj){if(null==obj||"object"!=typeof obj)return obj;var copy=obj.constructor();for(var attr in obj)obj.hasOwnProperty(attr)&&(copy[attr]=obj[attr]);return copy},baseReqUrl="http://forbes.comeoncloud.net/serv/pubapi.ashx",params={appid:"appid",appsecret:"appsecret",callback:"JSON_CALLBACK"},resource=$resource(baseReqUrl,null,{get:{method:"JSONP"}});return{get:function(subparams){var temp=objClone(params);for(var i in subparams)temp[i]=subparams[i];var resp=resource.get(temp);return console.log(resp),resp}}}),angular.module("fbs.services").factory("Tools",function($state,$ionicHistory,$timeout,$rootScope){var options={location:!0,reload:!0},pageSkip=function(url,params){$state.go(url,params,options)},pageReturn=function(){var retObj=$ionicHistory.backView();$ionicHistory.backView()?"login"==$state.$current.self.name?$state.go("index"):$state.go(retObj.stateName,retObj.stateParams,options):$state.go("index")},msgShow=function(msg){$rootScope.msg_show=!0,$rootScope.msg_cont=msg,$timeout(function(){$rootScope.msg_show=!1},3e3)},isLogin=function(){return!0};return{pageSkip:pageSkip,pageReturn:pageReturn,msgShow:msgShow,isLogin:isLogin}}),angular.module("fbs.services").factory("AtteLcs",function(DataAPI,Tools){var atte=function(licaishi){var atteStatus=licaishi.isattention;atteStatus?(console.log("取消关注理财师"),DataAPI.get({action:"cancelattention",touserid:licaishi.userid}).$promise.then(function(resp){console.log(resp.errcode),0==resp.errcode?(console.log("取消关注成功"),licaishi.isattention=!licaishi.isattention):1==resp.errcode?console.log("取消关注失败"):-1==resp.errcode?Tools.msgShow("尚未登录"):2==resp.errcode&&console.log("已经关注过了")})):(console.log("关注理财师"),DataAPI.get({action:"addattention",touserid:licaishi.userid}).$promise.then(function(resp){0==resp.errcode?(console.log("关注成功"),licaishi.isattention=!licaishi.isattention):1==resp.errcode?console.log("关注失败"):-1==resp.errcode&&Tools.msgShow("尚未登录")}))};return{atte:atte}}),angular.module("fbs.filters").filter("activityStatusTextFilter",function(){return function(input){var ret;return 0==input&&(ret="进行中"),1==input&&(ret="已结束"),2==input&&(ret="满员"),ret}}),angular.module("fbs.filters").filter("msgTypeFilter",function(){return function(input){var ret;return 0==input&&(ret="发表了文章"),1==input&&(ret="发表了活动"),2==input&&(ret="发表了话题"),3==input&&(ret="回答了话题"),ret}}),angular.module("fbs.filters").filter("lcsAttention",function(){return function(input){var ret;return input||(ret="关注"),input&&(ret="取消关注"),ret}}),angular.module("fbs.filters").filter("articleCatFilter",function(){return function(input){var tempCategories=[];return angular.forEach(input,function(category){498!=category.categoryid&&499!=category.categoryid&&tempCategories.push(category)}),tempCategories}}),angular.module("fbs.filters").filter("articleFilter",function(){return function(input){var tempArticles=[];return angular.forEach(input,function(article){498!=article.cateid&&499!=article.cateid&&tempArticles.push(article)}),tempArticles}}),angular.module("fbs.directives").directive("hideFooter",function($rootScope){return{restrict:"A",link:function(scope,element,attributes){scope.$watch(attributes.hideFooter,function(value){$rootScope.hideFooter=value})}}}),angular.module("fbs.directives").directive("searchByKeyword",function(DataAPI){function link(scope,element){element.bind("click",function(){scope.$apply(function(){scope.reqOptions.keyword=scope.keyword,scope.targetDatas=DataAPI.get(scope.reqOptions)})})}return{restrict:"A",scope:{keyword:"=",reqOptions:"=",targetDatas:"="},link:link}}),angular.module("fbs.directives").directive("searchByCategory",function(DataAPI){function link(scope,element,attrs){element.bind("click",function(){scope.$apply(function(){var current_id=attrs.categoryId;scope.reqOptions.cateid=current_id,9999==current_id&&(scope.reqOptions.cateid=null),scope.current=current_id,scope.targetDatas=DataAPI.get(scope.reqOptions)})})}return{restrict:"A",scope:{reqOptions:"=",targetDatas:"=",current:"="},link:link}}),angular.module("fbs.directives").directive("addMoreList",function(DataAPI){function link(scope,element){element.bind("click",function(){scope.reqOptions.pageindex++,scope.$apply(function(){scope.loadingShow=!0,DataAPI.get(scope.reqOptions).$promise.then(function(resp){if(scope.loadingShow=!1,0==resp.list.length)return void(scope.isOver=!0);for(var i=0;i<resp.list.length;i++)scope.targetDatas.list.push(resp.list[i])})})})}return{restrict:"A",scope:{reqOptions:"=",targetDatas:"=",isOver:"=",loadingShow:"="},link:link}}),angular.module("fbs.directives").directive("sentYzm",function($interval,DataAPI){function link(scope,element){function updateTime(){element.text(start--+"s")}var timeoutId,deplyNum=60,start=deplyNum;element.bind("click",function(){DataAPI.get({action:"getsmsvercode",phone:scope.phone}).$promise.then(function(resp){0==resp.errcode?(console.log("发送成功"),scope.divDisable=!0,element.text(start--+"s"),timeoutId=$interval(function(){updateTime()},1e3,deplyNum).then(function(){scope.div_disable=!1,element.text("验证码"),start=deplyNum})):console.log(resp)})}),element.on("$destroy",function(){$interval.cancel(timeoutId)})}return{restrict:"A",scope:{divDisable:"=",phone:"="},link:link}}),angular.module("fbs.directives").directive("lcsHistory",function(){function link(scope,element,attrs){element.bind("click",function(){scope.$apply(function(){console.log(scope.leftDisabled),"left"==attrs.operat?(scope.currentJieshu--,scope.leftDisabled=!0):scope.currentJieshu++})})}return{restrict:"A",scope:{currentJieshu:"=",leftDisabled:"=",operat:"="},link:link}}),angular.module("fbs.directives").directive("replyWenda",function(DataAPI,Tools){function link(scope,element,attrs){element.bind("click",function(){var replyOptions={action:"replyask",content:scope.replyBody,id:attrs.wendaId};scope.$apply(function(){DataAPI.get(replyOptions).$promise.then(function(resp){0==resp.errcode?(scope.replyBody="",scope.targetData=DataAPI.get(scope.reqOptions),Tools.msgShow(resp.errmsg)):(console.log("失败"),Tools.msgShow(resp.errmsg))})})})}return{restrict:"A",scope:{replyBody:"=",reqOptions:"=",targetData:"="},link:link}});